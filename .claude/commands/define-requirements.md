# プロジェクト要件定義作成コマンド

あなたはプロダクトマネージャーとして、ユーザーと対話しながら新規プロジェクトの要件定義を作成します。

## 実行手順

### ステップ1: プロジェクトの基本情報をヒアリング

以下の質問を**順番に1つずつ**行い、回答を記録してください:

1. **プロジェクト名** - どのようなプロジェクトですか？（例: タスク管理アプリ、ECサイト、予約システム）
2. **ターゲットユーザー** - 誰のためのサービスですか？（例: エンジニア、中小企業、個人事業主）
3. **解決する課題** - どんな問題を解決しますか？
4. **プラットフォーム** - どこで使われますか？
   - [ ] Web（ブラウザ）
   - [ ] iOS/Android（モバイルアプリ）
   - [ ] デスクトップアプリ
   - [ ] 複数プラットフォーム

### ステップ2: コア機能の洗い出し

**「これがないとサービスが成立しない」という最小限の機能（MVP）**を3-5個リストアップしてください。

例:
- ユーザー登録・ログイン
- タスクの作成・編集・削除
- タスク一覧の表示

### ステップ3: ユーザーストーリーの作成

各コア機能について、以下の形式でユーザーストーリーを作成:

```
【誰が】として、
【何をしたい】、
【なぜなら】
```

例:
```
【プロジェクトメンバー】として、
【タスクの進捗状況を一覧で確認したい】、
【なぜなら】チーム全体の作業状況を把握する必要があるから
```

### ステップ4: 技術スタックの確認

このスターターキット（Rails 8 + React Native）で要件を満たせるか確認:

- ✅ **Web**: Rails 8 + HAML + Hotwire + Tailwind CSS
- ✅ **Mobile**: React Native + Expo + NativeWind
- ✅ **API**: Rails API + JWT認証
- ✅ **DB**: PostgreSQL
- ✅ **認証**: Devise
- ✅ **認可**: Pundit
- ✅ **ジョブ**: Solid Queue（バックグラウンド処理）

追加が必要な技術があればリストアップ:
- 例: 決済（Stripe）、リアルタイム通信（WebSocket）、通知（Push通知）

### ステップ5: データモデルの設計

主要なデータモデルとその関連を洗い出し:

```
例: タスク管理アプリの場合

User（ユーザー）
├── has_many :tasks
└── belongs_to :organization

Organization（組織）
├── has_many :users
└── has_many :projects

Project（プロジェクト）
├── belongs_to :organization
└── has_many :tasks

Task（タスク）
├── belongs_to :user
├── belongs_to :project
└── has_many :comments

Comment（コメント）
└── belongs_to :task
```

### ステップ6: 画面設計（主要な画面のみ）

主要な画面を3-5個リストアップ:

1. **ダッシュボード** - タスク一覧と統計情報
2. **タスク詳細** - タスクの詳細情報と編集
3. **プロジェクト管理** - プロジェクト一覧と作成
4. **ユーザー設定** - プロフィール編集

各画面について:
- 表示する情報
- 実行できるアクション
- 必要な権限

### ステップ7: 非機能要件の確認

以下の項目について確認:

1. **パフォーマンス**
   - 同時アクセス数の想定は？
   - レスポンスタイムの要件は？

2. **セキュリティ**
   - 個人情報を扱う？（GDPR対応が必要？）
   - 決済情報を扱う？（PCI DSS対応が必要？）
   - アクセス制御の粒度は？

3. **スケーラビリティ**
   - ユーザー数の成長予測は？
   - データ量の増加見込みは？

4. **可用性**
   - ダウンタイムの許容度は？
   - バックアップの頻度は？

### ステップ8: 優先順位付け（MoSCoW法）

機能を以下の4つに分類:

**Must have（必須）** - これがないとローンチできない
**Should have（重要）** - できればローンチ時に欲しい
**Could have（あれば良い）** - 余裕があれば実装
**Won't have（将来）** - 今回は実装しない

### ステップ9: 要件定義書の生成

すべての情報を元に、以下の形式で要件定義書を `docs/REQUIREMENTS.md` に作成:

```markdown
# プロジェクト要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
[プロジェクト名]

### 1.2 目的
[解決する課題]

### 1.3 ターゲットユーザー
[ターゲットユーザー]

### 1.4 プラットフォーム
- [ ] Web
- [ ] iOS
- [ ] Android

## 2. ユーザーストーリー

### 2.1 コア機能

#### 機能1: [機能名]
**ユーザーストーリー:**
【誰が】として、
【何をしたい】、
【なぜなら】

**受け入れ条件:**
- [ ] 条件1
- [ ] 条件2

#### 機能2: [機能名]
...

## 3. データモデル

### 3.1 ER図（概念）

\`\`\`
User
├── has_many :tasks
└── belongs_to :organization
...
\`\`\`

### 3.2 主要モデルの詳細

#### User（ユーザー）
- **属性:**
  - email: string (必須, ユニーク)
  - name: string
  - role: enum (owner, admin, member)

- **関連:**
  - belongs_to :organization
  - has_many :tasks

## 4. 画面設計

### 4.1 主要画面一覧

#### ダッシュボード
- **目的:** タスクの概要表示
- **表示情報:**
  - 進行中のタスク一覧
  - 完了したタスク数
  - 期限が近いタスク
- **アクション:**
  - タスクの新規作成
  - タスクの完了マーク
- **権限:** ログインユーザー

## 5. 技術スタック

### 5.1 採用技術
- **Backend:** Rails 8.0
- **Frontend (Web):** HAML + Hotwire + Tailwind CSS
- **Frontend (Mobile):** React Native + Expo
- **Database:** PostgreSQL
- **認証:** Devise + JWT
- **認可:** Pundit

### 5.2 追加が必要な技術
- [ ] Stripe (決済)
- [ ] Push通知 (Expo Notifications)
- [ ] WebSocket (リアルタイム通信)

## 6. 非機能要件

### 6.1 パフォーマンス
- 同時アクセス数: 100ユーザー
- レスポンスタイム: 2秒以内

### 6.2 セキュリティ
- HTTPS通信必須
- CSRF対策
- XSS対策
- SQLインジェクション対策

### 6.3 スケーラビリティ
- 初年度: 1,000ユーザー
- 3年後: 10,000ユーザー

## 7. 優先順位（MoSCoW）

### Must have（必須 - MVP）
- [ ] ユーザー登録・ログイン
- [ ] タスク作成・編集・削除
- [ ] タスク一覧表示

### Should have（重要）
- [ ] タスクの検索・フィルタ
- [ ] コメント機能
- [ ] 通知機能

### Could have（あれば良い）
- [ ] タスクのタグ付け
- [ ] ファイル添付
- [ ] 統計ダッシュボード

### Won't have（将来）
- [ ] AIによるタスク提案
- [ ] 外部サービス連携（Slack, GitHub等）

## 8. 開発スケジュール（想定）

### フェーズ1: MVP開発（4-6週間）
- Week 1-2: データモデル設計と実装
- Week 3-4: コア機能実装
- Week 5-6: テストと調整

### フェーズ2: 機能拡張（2-4週間）
- Should have機能の実装

### フェーズ3: リリース準備（1-2週間）
- パフォーマンスチューニング
- セキュリティ監査
- ドキュメント整備

## 9. リスクと対策

### リスク1: [リスク内容]
- **影響度:** 高/中/低
- **発生確率:** 高/中/低
- **対策:** [対策内容]

## 10. 次のアクション

- [ ] データモデルの詳細設計
- [ ] API仕様書の作成（/create-spec コマンド使用）
- [ ] 画面モックアップの作成
- [ ] 開発環境のセットアップ
\`\`\`

## 出力形式

要件定義書を `docs/REQUIREMENTS.md` に保存してください。

## 完了メッセージ

要件定義書の作成が完了したら、以下のメッセージを表示:

```
✅ プロジェクト要件定義書を作成しました

📄 保存場所: docs/REQUIREMENTS.md

🎯 次のステップ:
1. 要件定義書をレビューして確認
2. データモデルの詳細設計
3. /create-spec コマンドで各機能の仕様書を作成
4. 開発開始!

💡 Tips:
- 要件が変わったら都度更新してください
- チーム全員が読める場所に置きましょう
- 実装中に疑問が出たら要件定義に戻りましょう
```

## 注意事項

- ユーザーと**対話形式**で進めること（一度に全部聞かない）
- ユーザーの回答が曖昧な場合は、具体例を出して明確化すること
- 技術的に実現困難な要件があれば、代替案を提案すること
- MVPに集中し、過剰な機能追加を避けること
- 要件定義は生きたドキュメントであり、変更可能であることを伝えること
